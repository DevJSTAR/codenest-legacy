<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='logoGradient' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%235865F2'/%3E%3Cstop offset='100%25' style='stop-color:%234752C4'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cg%3E%3Cpath d='M30 20 L45 10 L70 10 L85 25 L85 75 L70 90 L45 90 L30 80' fill='transparent' stroke='url(%23logoGradient)' stroke-width='4' stroke-linecap='round' stroke-linejoin='round'/%3E%3Crect x='40' y='30' width='30' height='4' rx='2' fill='white'/%3E%3Crect x='40' y='40' width='20' height='4' rx='2' fill='white'/%3E%3Crect x='40' y='50' width='25' height='4' rx='2' fill='white'/%3E%3C/g%3E%3C/svg%3E">
    
    <title>Sign Up - CodeNest</title>
    <meta name="description" content="Join CodeNest - Create your personal space for organizing code snippets and development notes.">

    <meta name="title" content="CodeNest - Developer Notes">
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://codenestapp.vercel.app/">
    <meta property="og:title" content="CodeNest - Developer Notes">
    <meta property="og:description" content="Your personal space for organizing code snippets, development notes, and programming knowledge.">
    <meta property="og:image" content="https://codenestapp.vercel.app/images/og-image.png">
    
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://codenestapp.vercel.app/">
    <meta property="twitter:title" content="CodeNest - Developer Notes">
    <meta property="twitter:description" content="Your personal space for organizing code snippets, development notes, and programming knowledge.">
    <meta property="twitter:image" content="https://codenestapp.vercel.app/og-image.png">
    
    <meta name="theme-color" content="#5865F2">
    <meta name="msapplication-TileColor" content="#5865F2">
    <meta name="msapplication-navbutton-color" content="#5865F2">
    <meta name="apple-mobile-web-app-status-bar-style" content="#5865F2">

    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/animations.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
    </script>
    <style>
        .auth-button {
            position: relative;
        }

        .auth-button .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .auth-button .success-icon {
            display: none;
            color: white;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .auth-button.loading span,
        .auth-button.loading svg {
            visibility: hidden;
        }

        .auth-button.loading .loading-spinner {
            display: block;
        }

        .auth-button.success span,
        .auth-button.success svg {
            visibility: hidden;
        }

        .auth-button.success .success-icon {
            display: block;
        }

        @keyframes spin {
            to { transform: translateX(-50%) rotate(360deg); }
        }
    </style>
</head>
<body class="auth-page">
    <div class="auth-background">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
    </div>

    <svg class="app-logo theme-toggle" viewBox="0 0 100 100">
        <defs>
            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:var(--accent-color)" />
                <stop offset="100%" style="stop-color:var(--hover-color)" />
            </linearGradient>
        </defs>
        <path class="logo-shape" d="M30 20 L45 10 L70 10 L85 25 L85 75 L70 90 L45 90 L30 80" fill="none" stroke="url(#logoGradient)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
        <rect x="40" y="30" width="30" height="4" rx="2" fill="var(--text-primary)" class="logo-line"/>
        <rect x="40" y="40" width="20" height="4" rx="2" fill="var(--text-primary)" class="logo-line"/>
        <rect x="40" y="50" width="25" height="4" rx="2" fill="var(--text-primary)" class="logo-line"/>
    </svg>

    <h1>Create Account</h1>
    <p class="auth-description">Join CodeNest to start organizing your notes</p>

    <form id="signup-form" class="auth-form">
        <div class="form-group">
            <label for="username">
                <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" fill="none" class="icon">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                    <circle cx="12" cy="7" r="4"/>
                </svg>
                Username
            </label>
            <input type="text" id="username" name="username" required>
        </div>
        <div class="form-group">
            <label for="email">
                <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" fill="none" class="icon">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                    <polyline points="22,6 12,13 2,6"/>
                </svg>
                Email
            </label>
            <input type="email" id="email" name="email" required pattern="[^+@]+@[^@]+\.[^@]+" title="Email cannot contain '+' symbol">
        </div>
        <div class="form-group">
            <label for="password">
                <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" fill="none" class="icon">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                </svg>
                Password
            </label>
            <div class="password-input">
                <input type="password" id="password" name="password" required>
                <button type="button" class="toggle-password" aria-label="Toggle password visibility">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" fill="none" class="icon eye-open">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" fill="none" class="icon eye-closed">
                        <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                        <line x1="1" y1="1" x2="23" y2="23"/>
                    </svg>
                </button>
            </div>
        </div>
        <div id="error-message"></div>
        <button type="submit" class="auth-button">
            <span>Create Account</span>
            <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" fill="none" class="icon">
                <path d="M5 12h14m-7-7l7 7-7 7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <div class="loading-spinner"></div>
            <div class="success-icon">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 6L9 17L4 12" stroke="#FFFFFF"/>
                </svg>
            </div>
        </button>
    </form>
    <p class="auth-link">Already have an account? <a href="/login">Login</a></p>

    <script>
        document.querySelector('.theme-toggle').addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });

        document.querySelector('.toggle-password').addEventListener('click', function() {
            const input = document.getElementById('password');
            input.type = input.type === 'password' ? 'text' : 'password';
            this.classList.toggle('showing');
        });
        
        document.getElementById('signup-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const button = e.target.querySelector('.auth-button');
            const errorMessage = document.getElementById('error-message');
            
            try {
                button.classList.add('loading');
                errorMessage.textContent = '';

                const response = await fetch('/api/auth/signup', {
                    method: 'POST',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        username: document.getElementById('username').value,
                        email: document.getElementById('email').value,
                        password: document.getElementById('password').value
                    })
                });

                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error);
                }

                localStorage.setItem('user_token', data.token);
                localStorage.setItem('user_data', JSON.stringify(data.user));

                button.classList.remove('loading');
                button.classList.add('success');

                setTimeout(() => {
                    window.location.href = '/';
                }, 1000);

            } catch (error) {
                button.classList.remove('loading');
                errorMessage.textContent = error.message;
            }
        });
    </script>
</body>
</html> 